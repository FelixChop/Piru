(function() {
const i18nResources = {
  en: {
    translation: {
      site_name: 'Piru',
      tagline: 'Consume media in foreign languages.',
      login: 'Login',
      sign_up: 'Sign Up',
      email: 'Email',
      password: 'Password',
      native_language: 'Native language',
      learning_language: 'Language to learn',
      select_language: 'Select language',
      your_works: 'Your Works',
      title: 'Title',
      author: 'Author',
      content: 'Content',
      add_work: 'Add Work',
      add: 'Add',
      added: 'Added',
      search_books: 'Search a Book',
      search_movies_series: 'Search a Film or TV Series',
      search_lyrics: 'Search a Song',
      manual_add: 'Manual Add',
      search: 'Search',
      type: 'Type',
      book: 'Book',
      movie: 'Movie',
      series: 'Series',
      song: 'Song',
      add_new_work: 'Add New Work',
      movie_series: 'Movie / Series',
      custom: 'Custom',
      account_created: 'Account created. You can now log in.',
      language_unavailable: 'Language not available',
      statistics: 'Statistics',
      total_words_encountered: 'Total words encountered:',
      mastered_words: 'Mastered words:',
      review_vocabulary: 'Review Vocabulary',
      my_works: 'My Works',
      learn: 'Learn',
      delete: 'Delete',
      view_stats: 'View Stats',
      logout: 'Logout',
      settings: 'Settings',
      delete_account: 'Delete Account',
      confirm_delete_work: 'Are you sure you want to delete this work?',
      confirm_delete_account: 'Are you sure you want to delete your account? This action cannot be undone.',
      vocabulary_review: 'Vocabulary Review',
      show_definition: 'Show Definition',
      delete_known: 'Delete because I already know it',
      i_know: 'I know',
      i_dont_know: "I don't know",
      again: 'Again',
      good: 'Good',
      no_words: 'No words to review',
      lyrics_fetch_failed: 'Failed to fetch lyrics',
      create_challenge: 'Create Challenge',
      challenge_link: 'Challenge link',
      finish_challenge: 'Finish Challenge',
      your_score: 'Your score:',
      opponent_score: "Friend's score:",
      winner: 'Winner:',
      waiting_for_opponent: 'Waiting for friend...',
      you: 'You',
      friend: 'Friend'
    }
  },
  fr: {
    translation: {
      site_name: 'Piru',
      tagline: 'Consomme des médias en langues étrangères.',
      login: 'Connexion',
      sign_up: 'Inscription',
      email: 'Email',
      password: 'Mot de passe',
      native_language: 'Langue maternelle',
      learning_language: 'Langue à apprendre',
      select_language: 'Choisir une langue',
      your_works: 'Vos œuvres',
      title: 'Titre',
      author: 'Auteur',
      content: 'Contenu',
      add_work: 'Ajouter une œuvre',
      add: 'Ajouter',
      added: 'Ajouté',
      search_books: 'Rechercher un livre',
      search_movies_series: 'Rechercher un film ou série TV',
      search_lyrics: 'Rechercher une chanson',
      manual_add: 'Ajout manuel',
      search: 'Rechercher',
      type: 'Type',
      book: 'Livre',
      movie: 'Film',
      series: 'Série',
      song: 'Chanson',
      add_new_work: 'Ajouter une nouvelle œuvre',
      movie_series: 'Film / Série',
      custom: 'Personnalisé',
      account_created: 'Compte créé. Vous pouvez maintenant vous connecter.',
      language_unavailable: "Cette langue n'est pas disponible",
      statistics: 'Statistiques',
      total_words_encountered: 'Nombre total de mots rencontrés :',
      mastered_words: 'Mots maîtrisés :',
      review_vocabulary: 'Réviser le vocabulaire',
      my_works: 'Mes œuvres',
      learn: 'Apprendre',
      delete: 'Supprimer',
      view_stats: 'Voir ses stats',
      logout: 'Déconnexion',
      settings: 'Paramètres',
      delete_account: 'Supprimer le compte',
      confirm_delete_work: 'Êtes-vous sûr de vouloir supprimer cette œuvre ?',
      confirm_delete_account: 'Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible.',
      vocabulary_review: 'Révision du vocabulaire',
      show_definition: 'Afficher la définition',
      delete_known: 'Supprimer car je connais déjà',
      i_know: 'Je connais',
      i_dont_know: "Je ne connais pas",
      again: 'Encore',
      good: 'Bien',
      no_words: 'Aucun mot à réviser',
      lyrics_fetch_failed: 'Échec de récupération des paroles',
      create_challenge: 'Créer un challenge',
      challenge_link: 'Lien du challenge',
      finish_challenge: 'Terminer le challenge',
      your_score: 'Ton score :',
      opponent_score: 'Score de ton ami :',
      winner: 'Gagnant :',
      waiting_for_opponent: 'En attente de ton ami...',
      you: 'Toi',
      friend: 'Ami'
    }
  },
  es: {
    translation: {
      site_name: 'Piru',
      tagline: 'Consume medios en idiomas extranjeros.',
      login: 'Iniciar sesión',
      sign_up: 'Registrarse',
      email: 'Correo electrónico',
      password: 'Contraseña',
      native_language: 'Idioma nativo',
      learning_language: 'Idioma a aprender',
      select_language: 'Seleccionar idioma',
      your_works: 'Tus obras',
      title: 'Título',
      author: 'Autor',
      content: 'Contenido',
      add_work: 'Agregar obra',
      add: 'Agregar',
      added: 'Agregado',
      search_books: 'Buscar un libro',
      search_movies_series: 'Buscar una película o serie de TV',
      search_lyrics: 'Buscar una canción',
      manual_add: 'Agregar manualmente',
      search: 'Buscar',
      type: 'Tipo',
      book: 'Libro',
      movie: 'Película',
      series: 'Serie',
      song: 'Canción',
      add_new_work: 'Agregar una nueva obra',
      movie_series: 'Película / Serie',
      custom: 'Personalizado',
      account_created: 'Cuenta creada. Ahora puedes iniciar sesión.',
      language_unavailable: 'Idioma no disponible',
      statistics: 'Estadísticas',
      total_words_encountered: 'Total de palabras encontradas:',
      mastered_words: 'Palabras dominadas:',
      review_vocabulary: 'Repasar vocabulario',
      my_works: 'Mis obras',
      learn: 'Aprender',
      delete: 'Eliminar',
      view_stats: 'Ver estadísticas',
      logout: 'Cerrar sesión',
      settings: 'Configuración',
      delete_account: 'Eliminar cuenta',
      confirm_delete_work: '¿Seguro que deseas eliminar esta obra?',
      confirm_delete_account: '¿Seguro que quieres eliminar tu cuenta? Esta acción no se puede deshacer.',
        vocabulary_review: 'Revisión de vocabulario',
        show_definition: 'Mostrar definición',
        delete_known: 'Eliminar porque ya la conozco',
        i_know: 'La conozco',
        i_dont_know: 'No la conozco',
        again: 'De nuevo',
        good: 'Bien',
        no_words: 'No hay palabras para repasar',
        lyrics_fetch_failed: 'No se pudieron obtener las letras',
      create_challenge: 'Crear desafío',
      challenge_link: 'Enlace del desafío',
      finish_challenge: 'Terminar desafío',
      your_score: 'Tu puntuación:',
      opponent_score: 'Puntuación de tu amigo:',
      winner: 'Ganador:',
      waiting_for_opponent: 'Esperando a tu amigo...',
      you: 'Tú',
      friend: 'Amigo'
    }
  },
  it: {
    translation: {
      site_name: 'Piru',
      tagline: 'Consuma media in lingue straniere.',
      login: 'Accesso',
      sign_up: 'Registrati',
      email: 'Email',
      password: 'Password',
      native_language: 'Lingua madre',
      learning_language: 'Lingua da imparare',
      select_language: 'Seleziona lingua',
      your_works: 'Le tue opere',
      title: 'Titolo',
      author: 'Autore',
      content: 'Contenuto',
      add_work: 'Aggiungi opera',
      add: 'Aggiungi',
      added: 'Aggiunto',
      search_books: 'Cerca un libro',
      search_movies_series: 'Cerca un film o serie TV',
      search_lyrics: 'Cerca una canzone',
      manual_add: 'Aggiunta manuale',
      search: 'Cerca',
      type: 'Tipo',
      book: 'Libro',
      movie: 'Film',
      series: 'Serie',
      song: 'Canzone',
      add_new_work: 'Aggiungi una nuova opera',
      movie_series: 'Film / Serie',
      custom: 'Personalizzato',
      account_created: 'Account creato. Ora puoi accedere.',
      language_unavailable: 'Lingua non disponibile',
      statistics: 'Statistiche',
      total_words_encountered: 'Totale parole incontrate:',
      mastered_words: 'Parole padroneggiate:',
      review_vocabulary: 'Ripassa il vocabolario',
      my_works: 'Le mie opere',
      learn: 'Imparare',
      delete: 'Elimina',
      view_stats: 'Vedi statistiche',
      logout: 'Esci',
      settings: 'Impostazioni',
      delete_account: 'Elimina account',
      confirm_delete_work: 'Sei sicuro di voler eliminare quest\'opera?',
      confirm_delete_account: 'Sei sicuro di voler eliminare il tuo account? Questa azione non può essere annullata.',
      vocabulary_review: 'Revisione del vocabolario',
      show_definition: 'Mostra definizione',
      delete_known: 'Elimina perché la conosco già',
      i_know: 'La conosco',
      i_dont_know: 'Non la conosco',
      again: 'Di nuovo',
      good: 'Bene',
      no_words: 'Nessuna parola da ripassare',
      lyrics_fetch_failed: 'Impossibile recuperare i testi',
      create_challenge: 'Crea sfida',
      challenge_link: 'Link della sfida',
      finish_challenge: 'Termina sfida',
      your_score: 'Il tuo punteggio:',
      opponent_score: "Punteggio dell'amico:",
      winner: 'Vincitore:',
      waiting_for_opponent: "In attesa dell'amico...",
      you: 'Tu',
      friend: 'Amico'
    }
  },
  de: {
    translation: {
      site_name: 'Piru',
      tagline: 'Konsumiere Medien in Fremdsprachen.',
      login: 'Anmelden',
      sign_up: 'Registrieren',
      email: 'E-Mail',
      password: 'Passwort',
      native_language: 'Muttersprache',
      learning_language: 'Zu lernende Sprache',
      select_language: 'Sprache auswählen',
      your_works: 'Deine Werke',
      title: 'Titel',
      author: 'Autor',
      content: 'Inhalt',
      add_work: 'Werk hinzufügen',
      add: 'Hinzufügen',
      added: 'Hinzugefügt',
      search_books: 'Ein Buch suchen',
      search_movies_series: 'Einen Film oder eine TV-Serie suchen',
      search_lyrics: 'Ein Lied suchen',
      manual_add: 'Manuelles Hinzufügen',
      search: 'Suchen',
      type: 'Typ',
      book: 'Buch',
      movie: 'Film',
      series: 'Serie',
      song: 'Lied',
      add_new_work: 'Neues Werk hinzufügen',
      movie_series: 'Film / Serie',
      custom: 'Benutzerdefiniert',
      account_created: 'Konto erstellt. Du kannst dich jetzt anmelden.',
      language_unavailable: 'Sprache nicht verfügbar',
      statistics: 'Statistiken',
      total_words_encountered: 'Gesamtzahl der Wörter:',
      mastered_words: 'Beherrschte Wörter:',
      review_vocabulary: 'Vokabeln wiederholen',
      my_works: 'Meine Werke',
      learn: 'Lernen',
      delete: 'Löschen',
      view_stats: 'Statistiken ansehen',
      logout: 'Abmelden',
      settings: 'Einstellungen',
      delete_account: 'Konto löschen',
      confirm_delete_work: 'Möchten Sie dieses Werk wirklich löschen?',
      confirm_delete_account: 'Möchten Sie Ihr Konto wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.',
      vocabulary_review: 'Vokabelwiederholung',
      show_definition: 'Definition anzeigen',
      delete_known: 'Löschen, da ich es bereits kenne',
      i_know: 'Ich kenne es',
      i_dont_know: 'Ich kenne es nicht',
      again: 'Nochmals',
      good: 'Gut',
      no_words: 'Keine Wörter zu wiederholen',
      lyrics_fetch_failed: 'Liedtext konnte nicht geladen werden',
      create_challenge: 'Challenge erstellen',
      challenge_link: 'Challenge-Link',
      finish_challenge: 'Challenge beenden',
      your_score: 'Dein Punktestand:',
      opponent_score: 'Punktestand deines Freundes:',
      winner: 'Gewinner:',
      waiting_for_opponent: 'Warte auf deinen Freund...',
      you: 'Du',
      friend: 'Freund'
    }
  }
};

function updateContent() {
  document.querySelectorAll('[data-i18n]').forEach(el => {
    el.textContent = i18next.t(el.dataset.i18n);
  });
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    el.placeholder = i18next.t(el.dataset.i18nPlaceholder);
  });
  document.documentElement.lang = i18next.language;
}

function initI18n(defaultLang = 'en', resourcesData = i18nResources) {
  return i18next.init({ lng: defaultLang, resources: resourcesData }).then(() => {
    updateContent();
  });
}

window.updateContent = updateContent;
window.initI18n = initI18n;
})();
